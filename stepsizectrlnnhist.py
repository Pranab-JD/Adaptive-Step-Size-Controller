from numpy import *
import tensorflow as tf
from keras.models import Sequential
from keras.layers import Dense
n_hist = 2

fd=[0.32571095547543033, 0.053618860734158794, 0.004950240817213469, -0.22322607966376687, 0.03784548497420455, -0.4667535016674343, 18.05731232840552, 0.002065463228005583, -0.10270407379901965, 0.3926173672605321, 11.253577075178905, -0.02647106317092922, 0.1074420040330227, -0.5829571378652789, 0.26462266696863435, -0.055197390706851486, 0.5939176832666455, 0.6490276340883412, -0.04896407690690364, -0.13766334237262018, 0.12731311792916858, -0.02568200412108389, 0.04201084275144995, -0.06807499573256562, -0.08965069619103966, 0.13482480365233254, 0.01492946512183569, -0.07781179607232834, -0.04668074461287308, 0.2814823836921886, 0.0067753153711046735, 0.027089298792281877, 0.15776695992073647, -0.13993587528431362, -0.029609950359206605, -0.0985924859882287, -0.00864781777266459, 0.0018510176407830594, 0.037316021396168665, 0.05812559276083516, -0.025511253445859063, -0.027249690952978994, -0.0541578940175706, 0.032834062490554615, 0.03270066843746635, 0.025286417871403098, -0.08382090163207725, -0.033851659712162106, 0.059736903518988034, 0.009456463951307548, 0.04372006676662825, 0.002334168718581109, 0.04379002291700368, -0.0017854151431564045, -0.03895249090751441, 0.05211042342141078, 0.004665953885477614, 0.006597397997408683, 0.036911730218111824, -0.09141575527270165, -1.0959984567596732, -0.1214602601576682, -0.2378582856096511, -0.17893431563185688, -0.29046777643944843, -0.07250816931359573, -0.00860666964482248, -0.3009249068855923, -0.17397538953552516, -0.9256754971853951, -0.43631182093118226, -0.05995535986478295, -0.16107095933238305, -1.0817346010393276, -1.0046514728249694, -0.01797347217547217, -0.29470330055589955, -0.38670782892901223, -0.21503614621377942, -0.3719888739015334, -0.5808579894213028, -0.058919012569972694, -0.04770897151422446, -0.1257405319830637, -0.3023298968457519, -0.3442968972443924, -0.4468567297422804, -0.02862123905571093, -0.3023921023794097, -0.14819835954520105, -0.30168641946508057, 0.14829936881320233, 0.03290441179494787, 0.20046466124030657, -0.6765044039019686, -0.04662737803394981, 0.21027791144733937, 0.10046093546718797, -0.09991044083281117, -0.4147481574219336, -0.7375182506699263, 0.1685751535161417, -0.3265736486823752, -0.6619002548378528, 0.09334387671456873, -0.19871634361661084, 0.0163767289947907, -0.07364391799220016, 0.19670720083450832, 0.3031510296039775, -0.02493328618313584, 0.4899863604278807, -0.09582672684045572, -0.0026680646264218497, -0.006135215943410613, 0.23708601431304593, -0.12379321855363253, -0.02198129864113834, 0.45428575261837634, -1.2673565908750988, -0.03386035075322456, 0.24346988168962713, -0.17417172828900626, 0.03429019587530071, -0.07598647186006752, 0.08197932368779642, 0.35123106493173456, 0.012643398829152086, 0.12609486837666736, 0.10462111559242179, 0.48987230093000367, 0.2824248782338589, -0.7285745266875303, 0.10114472456484268, 0.5782199418771249, -0.10722722514399578, -0.16392301643692603, 0.20041564604979242, -0.19596452013862714, -0.004359574586025722, -0.15718163416913722, 0.20793700119174788, -0.0012696235029914932, -0.34744219535310344, 0.04135505295816391, -0.1331433336931609, 0.3097027373277618, -0.21868181420296462, 0.1775210024773466, -0.026607443176259092, 0.04203856783725642, 0.13211890939262622, -0.16376997552221104, 0.04788266736042673, -0.296395026917052, -0.27969962116799213, -0.31396318128383677, 0.16987890174845996, 0.16880600938451382, 0.27018190001795755, -0.07499261937591022, 0.12673049499654437, -0.3217144343767557, -0.13883034408155775, 0.0900406214708597, 0.09737862486327789, 0.2481488288039651, -0.17679563256572906, 0.12451307868536565, 0.26050762270154626, -0.2250859401623291, 0.023995647663946004, -0.11815492130032752, 0.10275776611190875, -0.13467851478503468, 0.15153318920119557, -0.11542848408094698, 0.04009049409494421, -0.1563716128312801, -0.2862467536372601, -0.15510754701826807, 0.358317923999666, 0.22852657503439805, 0.6454881011878753, 1.304680085696277, -0.09918024200946432, -0.11282637307367024, -0.2274933757433531, -0.22485878644041948, -0.05662883649169784, 0.7875637718165219, 0.23613524184200416, -0.20588324075101194, 0.3974144301957203, -0.03619372078780121, 0.3136363117247272, 0.12028866813341516, -0.22263515865795547, 0.11049429752942463, -0.035136105811176294, 0.014572065942652368, 0.7809683273027316, 0.07170884789685063, -0.4673269856477845, -0.24088005167089316, -0.030466816717684142, -0.20385675615511772, -0.016674253191557575, 0.058546873823246935, -0.1442957657056425, -0.12040955561421192, 0.07540282879355073, 0.031230732612666665, 0.1885901958700133, -0.02502347440233345, 0.018487412757028865, -0.26546046160048864, 0.29661305484176975, 0.263097639750049, 0.0035006351915383483, -0.043811875019579595, -0.03423653693742908, 0.18810970327632726, -0.31486529907508964, -0.021980773446993174, -0.21693346029469485, -0.18733022436538738, 0.13977427589637115, -0.03246438065217903, -0.1684127918234485, 0.3015573172470165, -0.197576079706984, -0.04220180141415534, 0.307590706277231, -0.23337898897966528, -0.10911869667564011, 0.43808362933520933, -0.07586821689622972, -0.11792740260141849, 0.012850906267449915, -0.07274807939502653, -1.043092825066857, -0.9055200412605207, -0.02332879239728024, -2.8468808174010736, -0.5085468101665288, -0.6180596880057277, -0.04010634025391582, -0.04746796267587844, -1.4236491761579735, -4.068081392519273, -0.6666146877581797, -0.6401069280381513, -2.0167059653430486, -0.5644935009380715, 0.06332172957057298, -0.32485136940063064, -1.6929321192279574, -1.1594893705135225, -0.2494084218922396, -0.2387521374571061, 0.2589747122793732, 0.0422078976258761, -1.8335383974813368, -1.5672218692374364, -0.8156084824331037, -0.5214319599509469, -0.001101321001418059, -0.586571456147093, -2.5149101570428423, 0.045806486964405896, -1.7307944692434403, -0.3244216147313846, -0.019340584255574153, 0.12877695998703778, -0.6575258508800229, -3.483310270207035, -0.2084494020139623, -0.6370543557628039, -0.4952889550537041, 0.2062418213312795, -0.146135158575874, -4.358184511364465, -0.3398466648414839, -4.089114133149259, -3.3775471306816303, -0.20138349575427963, -1.4135798505084753, -0.3306158105745325, -0.06025221043669922, -2.2474967776715324, -0.0008608941093259451, -6.003673243534664, -1.6551917289410978, 0.27439835076049274, -4.454965167996335, -0.9526980606743076, 0.04284465466432201, 0.36838441407402245, -0.11843341766276312, -0.1785631969213552, 0.14426801689675905, -0.38558254170309425, 0.11916797548177314, -0.5311320909557135, -0.08205628545664712, 0.06465583413818156, 0.371403438029621, 0.31708277578762, -0.046046697773768186, -0.5724307756853152, 0.14916856676405668, -0.32434152027456536, -0.03415813135368667, -0.138678837521452, 0.1609589587850247, 0.18485980142109093, 0.4716733566589793, 0.06743908929840267, 0.13093999674175522, 0.013542115892387394, -0.1524941185909096, -0.15728770981568788, 0.21789243855277005, 0.3054335502585168, -0.5586925572157698, -0.0732929619261351, -0.03356871357409612, 0.22064984645658597, -0.3014565321849412, -0.18351488090890722, 0.16974006563100658, 0.08100053123338131, 0.09837537877925648, -0.012252864587099031, -0.3446864348276357, -0.037046417876742885, 0.25033382525524883, -0.23066896773379494, -0.06632252916092887, 0.08280277900957955, 0.1530890522544109, -0.030443937714753132, -0.3428041184950509, 0.04140729783506816, -0.15627231633484345, 0.15436184815774723, 0.3010147468125405, -0.3692152006038616, -0.235061767420701, 0.2635157153778965, 0.24950795753743657, 0.19384862197461727, 0.1452915829011345, -0.1983979578374242, 0.03348531562575114, 0.41420792835739106, 0.1930861905659302, 0.023391037045594382, 0.14102498221871929, -0.20565767505839314, -0.13161756357624968, -0.08394089249644823, -0.042540045347942396, -0.6466376042839268, 0.15688405479141163, -0.27139638101881275, 0.37128103332578466, 0.13124370087333903, -0.5045342276023548, -0.031524499183345246, 0.8776336345753621, 0.1358257596411906, -0.7828555210368694, 0.257382921638187, 0.12088259744203225, -0.25718017147982075, 0.4248596879962697, -0.136030370759987, -0.24301712839961953, 0.1966847743796176, 0.171628347447763, 0.24708746947129434, 0.002796874113156343, 0.01964398488487449, 0.022466752709125924, -0.04529216241477273, 0.4890281636510269, 0.10546721957566828, -0.4764835814445531, -0.2995110066512283, -0.9923369783648337, -0.38766427125282266, -0.162571790191325, 0.33744075343394275, 0.12802502797026932, -0.9595064230727861, -0.18899728778254912, -0.4901974092684148, 0.26665121327071156, 0.18629453963214354, -0.049480091172296216, -0.7708749499011402, -0.3531365416291742, -1.3114157832170368, -1.7614373332637758, -0.1833208881736645, -2.676145372112891, 0.11070702883971303, -0.2226210681946103, -0.9104403664417255, 0.13294933886373342, -1.0787808652646647, -2.537573908636905, -0.02309229273046158, -2.007656313909706, -1.2994703984708482, -0.32293814501338036, -0.6725816546804182, 0.17134322600608243, -0.239289688536734, 0.4730992626749717, -2.3794263736526657, 0.8124076277128324, 0.19240762375962767, 0.11055068738373452, -0.15581309548860972, -0.34795533793049493, -0.10715126358778014, -0.5089763640517584, 0.8743641644703474, -0.5955341815256147, 0.0492081477061046, 0.021011582401647952, 0.0011832205023207532, 0.17893375501023764, -0.2801656786925372, -0.33466503566979, -0.6129895327354946, -0.03448862207795571, 0.3702578743474418, 0.5036080894498002, 0.05997273870181104, -0.06358629686990822, -0.19079661644725004, -0.16876101560743942, 0.15044575734244778, -0.35069032463273236, -0.142156576046999, -0.32708266311886336, 0.17909031946729226, -0.5188410625859777, -2.344245402728638, 0.09029960009558391, -1.618490174385204, -0.11227299387386849, 0.05845268448048222, -0.4994228792186916, -0.4779270516646125, -0.8158133161376427, -2.4957359308291602, -1.308348015281332, -0.7282845475005556, -0.8506629927583564, -0.3073118561248792, 0.010629564158588421, -0.43375382960247433, -0.7603371463991905, -1.1929216546760977, 0.11160887929742516, 0.2775886073437111, 0.08197883754202376, -0.1038459534117832, -0.4195045961760057, -0.5260067041015305, -0.3717090109958646, -0.5930108384298877, -0.3548507770623569, -0.4795235292862882, -0.8200297821161348, -0.05879537686564622, 0.025710541871034213, -0.09146223127535155, -0.09901152928116355, 0.10721599854041236, -0.2921426662334973, -0.15654123455365648, -0.18150412080328704, -0.19828847584744708, 0.1867246302938737, 0.10085807739653795, -0.27704002388257354, -0.013818486234027781, 0.4742511625413296, -0.06533336123967902, 0.41851808953123726, -0.271962226734334, -0.06913003621154278, -0.03315644853625042, -0.13424110460528732, 0.369632237829087, -0.24987354008928292, -1.7480960736239368, -0.016284955873284247, -0.305637740882688, -0.05468934264321239, 0.2631085782328257, -0.42940140928716386, 0.040675162111573494, -0.06377636460354423, 0.15041532757002538, 0.0031960607000405886, -0.22822965346705024, 0.5744212863042725, -0.425001702019975, 0.013763085169193702, -0.20169737390699854, -0.292353587374622, -0.19833283421332826, -0.9030133895616312, -0.43178406832716193, 0.3566032908776338, 0.2178268984464048, -0.4677649608016407, -0.05725393912536708, 0.27121183230802914, -0.0588437749551743, -0.2411463471850666, 0.24794692347676756, -0.034201609661941454, 0.031992543250104366, 0.43995571292452396, -0.29001267018360766, 0.2023037517480564, 0.5866444627405235, 0.16933203668434024, 0.22877703706432137, -0.06035984234156323, -0.08476018080685163, -1.4487250288637221, 0.18736993261957308, -0.21430294536439493, -0.24818870067126392, -0.27522431197758646, -0.18905616742615894, -0.12353786815680967, 0.26647319067845915, -0.15786765718145568, -0.18111936382673338, 0.02061022203800568, -0.21523921751340147, -0.15439758873322104, -0.11122970076702592, -0.3946730057029527, 0.1578226995730121, 0.20869361818497956, 0.09522223120056267, 0.48400993145758064, 0.2605041914859049, -0.39331253041285535, -0.29393479500239517, 0.15678489730157824, 0.005827868093148969, -0.27447631108434445, 0.42041244866157407, -0.33535990343642375, 0.14589503867595102, 0.053553721716943115, 0.33337760488341045, -0.29130576953059306, -0.1943655554821832, 0.21477476975680992, -0.020193802654053336, 0.0875575069489899, -0.2510688499839153, 0.0019599292907548794, 0.010706799199525587, -0.6763671472707793, -0.013018285969417495, -0.11061534538288917, -0.43863481631794443, -0.1704509864039033, -0.1815753969530193, -0.3893404777647061, -0.04188251908938842, 0.061537203496302394, 0.13796978178273311, -0.20401689719251115, -0.12250360615892153, -0.25708509138967384, -0.14383377604981992, 0.14773948725902802, 0.1272082446044927, -0.04359892202568279, -0.1969278351342144, -0.05608404661629539, 0.12266574505169937, 0.15378513446508918, -1.1591937225345035, -0.38557035366671744, -0.014937155049704633, 0.11563561447212366, -0.06779727809252459, -0.3002970929094924, -0.2798291914828971, 0.09856481107868091, -0.32011202060641314, -0.010414699967203372, 0.13765431457295912, -0.642886072375619, -0.03989438867570368, 0.20654265900192728, 0.03248745497746998, -0.7264887224973701, 0.05506549415554719, 0.013677627277130303, -0.42538454150142735, 0.01714651532847919, -0.20147900134882168, -0.6451995393892731, -0.3400893274465863, 0.2513401243052239, 0.113308269223094, -0.0631087182609371, 0.13199262574679943, -0.050424996686823, 0.09442281987882785, -0.03441110338011451, -0.9915238135904274, -0.3013582246927687, -0.29767929206271315, 0.3267630277538043, 0.06827371533305836, -0.05426700034907117, 0.2004507571185925, -0.42769893210834975, -0.043152050050685946, 0.04449936608467558, 0.1529465396038057, 0.07121793539313688, 0.16362651180422683, -0.20377380192851718, 0.3146237140106947, -0.4142096887150356, -0.04481064280308292, 0.03309072748643349, -0.08077828862764341, -0.10566878353551434, 0.13000732996167633, -0.26397621593951875, 0.3525931020007311, 0.15626697813596566, -0.02171279342553354, -0.044993647188950235, 0.22290970920582698, -0.07972131802518986, 0.4393497767239826, -0.2701407973384567, 0.10143154034144468, -0.09531131284102021, -0.25441346283707533, 0.013919273093872156, 0.016368425324450986, -0.06190140171564017, -0.05845110690525242, -0.13727628566142985, 0.17948833145193754, 0.14684966732936422, 0.1041113460713309, 0.1905244837829356, -1.9976678502531222, 0.19871779723934685, 0.03121529102791158, -0.23721161489568648, 0.16524609044103578, 0.010871378606264779, -0.36171176602417054, -0.058669480951928005, -0.04357038036979009, -0.17701791767576436, 0.017744163659234768, 0.08893769811909794, -0.044940077808805226, 0.15902195141013875, -0.21359891389149827, -0.3245848665847539, 0.028266327119660952, 0.11591656703666514, -0.08085116459884048, -0.2663261968404939, -0.02977249115510709, 0.1618106695268215, 0.04344515965992814, -0.06537861853674831, 0.34729797702517295, 0.2069280218194547, 0.1430798824853506, -0.3287559751714985, -0.040360635404626484, -0.3540489410599217, -0.00012661386427573196, -0.06131870769212573, -1.035759827436618, -0.07930885083120127, -0.07105330044121982, 0.2235556553836206, -0.19546615463742956, -0.15578772200178995, 0.14227649879246332, 0.24118570280995347, 0.11270510163103363, 0.17972132446646671, -0.09984673298843079, 0.1299565345381125, -0.15490148853592148, 0.1730319102693005, -0.03128292757000144, -0.032682718984645906, -0.3383704655177212, -0.08586371484869004, -0.04147205901442902, -0.061486754285241314, -3.043147509548946, 0.6077240047307619, 0.4649166228627964, 0.09301062143045408, -0.07980867686407364, -0.35715474085834664, -0.3150910719814853, -0.3263617335427338, -0.02726872453963916, 0.12152818985119491, -0.0392728968806985, -0.30441201388909084, -0.06531572047905271, 0.21887408651824292, 0.2292077293726132, 0.20590400391525895, -0.22488311937941655, -0.19243628184352707, 0.06300126901379824, 0.19430605067848042, 0.03287889008431473, -0.16617805028335292, 0.08409766096300886, 0.01888963281333346, -0.2160805479142757, -0.16373642521348752, -0.18489181343833708, -0.16631616585481807, -0.23769179415909159, 0.13300844074541812, 0.1759876550921845, 0.23718999689669362, 0.24173434275337183, 0.08716241731945656, 0.06024904144195718, 0.3837050001243986, 0.1473306703496743, -0.28147279221598503, 0.17788481625416425, -0.002413621109493669, -0.19876362357635183, -0.012503871479871337, 0.14028193398178837, 0.07547925610989295, -0.30271727259419723, 0.46086174324248785, -0.06045188175440593, -0.4887650515443269, -0.3195901998123927, -0.17996857701285876, 0.06075007974742885, 0.002584822825625624, -0.24740881979526697, 0.12858659892456625, -0.06248339179929818, 0.22898640502642914, -0.03025929022355315, 0.20300073644483224, 0.06929321548627168, 0.07832888868091203, -0.257472294311871, -0.19835341639762033, 0.4518013435887898, -0.1446724929694318, 0.007115457776995071, 0.18373229175838152, -0.03496660082064519, -0.06796967329519792, 0.20936046808646844, 0.5896619174666983, -0.10317190402165004, -0.4727423513024696, 0.04284913834363502, 0.23013537931631803, 0.17346950708702974, 0.47041676225383794, 0.07211375923702584, 0.014753568777412528, -0.01393326480722916, 0.5402222621578786, -0.09395696940508425, -0.7415444646230602, -0.06856790477746293, 0.15700310098709788, -0.011824262447373259, 0.019814446367520222, 0.2581630150750542, -0.14993280505656528, 0.11040203815576499, -0.19610465534363747, -0.04689183588996475, 0.41354582854062527, 0.1357065500469711, -0.2753256053063164, -0.07032864542152398, 0.17328827015233067, -0.03325944515492942, 0.11050125907291206, 0.36119719843275744, -0.3348089680092997, -0.14470209435632952, -0.1933357449954382, 0.22108258065715433, -0.01015018647955468, 0.11910457023676961, -0.06076182179576659, 0.07228944748076357, 0.1603852540342713, 0.2624497855925657, -0.12774437424671656, -0.14408213632974234, -0.0003515331251909212, 0.08645921103244034, 0.1036418633862956, 0.0713417429062366, 0.09014120506557488, -0.4353953015621064, -0.02311609057410663, -0.07387740005778262, 0.11385387295155795, -0.09998804332379477, 0.18575854390723592, 0.2525430379098055, -0.3310987165797205, 0.3653187346565545, 0.03628866783919339, 0.179453422549128, 0.1851889954767703, -0.09270378680202332, -0.4017015830196079, 0.04523504237666366, -0.16768282879686605, 0.00412253437793049, 0.15752620071247764, -0.2612044707038601, 0.312505072879046, -0.24206748708137638, 0.07184321281777703, 0.05396011087058723, -0.04151995470456481, -0.13902046450312044, -0.11134551424945797, 0.061441514667357186, 0.04713737259567853, -0.013625887359671449, 0.25620490058442963, 0.21240864703885115, -0.14366609940874414, -0.2986745583947833, 0.14666604172523728, -0.2805268413077377, 0.063688485569522, -0.3461780016623216, -0.307478661969918, 0.09980007119617215, -0.5825559282559383, -0.08914332232075586, 0.14145670369920912, 0.05810329541635241, -0.3391273502401913, 0.026495805879620207, -0.13127074144425432, 0.13567308592632915, -0.1019074991350103, -0.3447200780411115, -0.2227853280186304, -0.1247539869384898, 0.21256734927915824, 0.20731088216720467, -0.17668523101131653, -0.1713912767224966, 0.3008134340070374, 0.04521427861879852, 0.04650730950116115, 0.17458063847158192, -0.10503027816438655, -0.13121168515458156, -0.01151716665747815, -0.34897452658399786, -0.03473699462655199, 0.18573993449055914, -0.039430269639682505, 0.8913431497979152, -0.39424375935822725, 0.18917787803665395, 0.23999309426617202, -0.4988092558046552, 0.31547444630384347, 0.4558917852513275, -0.21259328444589556, -0.04445434740742543, 0.7276096214828051, 0.056818112725481, 0.02571126258207388, 0.176770799482239, 0.16017785511055715, 0.27143908068361655, -0.39960178929240675, 0.17517088572363004, 0.16954665955292847, -0.016249073972913114, -0.17071364623975396, 0.017934931035424664, 0.03695141738628968, -0.10802900526958502, -0.06912202741415606, 0.4682029504293763, 0.03455752451813744, 0.1140983608906867, 0.17714828500583465, 0.2185981863506697, -0.10690900258875073, 0.08030339128222683, -0.04672208958949371, -0.03241125244389785, -0.12390162246715697, -0.35942491092383216, -0.08485087799416718, -0.24998448961105857, -0.22030271886116792, 0.03446561362111634, -0.44698889627468696, -0.09102785022733223, 0.2413831488046845, -0.3063107501187584, 0.37352477816437313, 0.02036914997431144, -0.19647418538573175, -0.4028947740211789, -0.14437583127541687, -0.16301300928495227, 0.1303154233292752, 0.13943719106621522, -0.32073997662667997, -0.08616321620995161, 0.10994686954492278, 0.265686419177654, 0.1892692092997106, -0.3365230258022369, 0.16878953939776323, 0.19492801445563882, -0.0014121114923370329, -0.2648312011951525, -0.2856592077309087, -0.03069305780661262, -0.12767265469070113, -0.34486199457247574, -0.15607303079928056, -0.10250015788934998, -0.018162419520495507, -0.24592665388448134, -0.2917864738278135, -0.08612665453369169, 0.07053620834960272, -0.26791500958880576, 0.1611102261673069, -0.1078248598920758, -0.10701523194703841, 0.11285822451823412, -0.012967556889265396, -0.043327972740498794, -0.19475772258279053, -0.01123960233228534, 0.086481681864643, 0.20380888115118245, -0.015307279736811216, -0.24780434654728592, -0.2446506477499834, -0.08670037578620063, 0.05737166850829431, -0.08482538410003869, 0.22807434953447286, -0.13460832349492177, -0.09171376544368859, 0.24533347619536117, 0.010266447702783975, -0.04295958321817415, -0.01754317201060497, -0.0035389662533003158, -0.088325426636881, 0.09665731413367801, -0.33731584452735813, 0.13612231823736126, 1.1381184722974547, -0.18527956201547344, 0.49707315236027677, -0.03626838702875805, -0.039260378092661655, 0.8412096812519027, 0.45492247688495735, 0.18916513479785452, 0.5395205712736626, 0.5143787001573186, 0.2400948619550984, -0.08842934780429049, -0.07733852895311583, 0.20960459513651192, 0.8483311719467888, -0.04284631426263427, 0.18572922481034343, -1.2529431983355275, 0.15433088767060194, 0.04960171060013793, -0.30789826855958324, -0.6701094649438782, 0.0013006211246529235, 0.17980392123529598, 0.03567413999246967, -0.15009511443084617, 0.029282156635641605, -1.7149308928968403, 0.12250811259955964, -1.4529517139400818, -0.8721179196478823, -0.2437852997044011, 1.0761099266991008, 0.005030847152730511, -0.02915967765250423, -0.21425832413841112, 0.15698769364423376, -0.13069270233761682, 0.9639181268347865, 0.20975256183649071, -2.306372714675928, 0.052889359642221176, 0.032340049392191414, 0.027657175603429986, 0.10575039537076798, 0.52982202648813]


def create_nn():
    model = Sequential()
    model.add(Dense(30,activation='relu', input_shape=(2,)))
    model.add(Dense(30,activation='relu'))
    model.add(Dense(1,activation='tanh'))
    return model

def array_to_nn(lw):
    model = create_nn()
    start = 0
    for i, layer in zip(range(len(model.layers)),model.layers):
        old_w = layer.get_weights()
        n1 = old_w[0].shape
        n2 = old_w[1].shape
        n1len = n1[0]*n1[1]

        w = [lw[start:start+n1len], lw[start+n1len:start+n1len+n2[0]]]
        start += n1len + n2[0]

        w[0] = w[0].reshape(n1)
        w[1] = w[1].reshape(n2)

        layer.set_weights(w)
    return model


class cost_ctrler_nn:
    def __init__(self):
        self.model = array_to_nn(array(fd))

    def evaluate(self, l_cost, l_tau):
        grad_c = [(log(l_cost[-1])-log(l_cost[-2]))/(log(l_tau[-1])-log(l_tau[-2]))]
        for i in range(1,n_hist):
            if len(l_cost) > 1+i:
                grad_c.append( (log(l_cost[-(1+i)])-log(l_cost[-(2+i)]))/(log(l_tau[-(1+i)])-log(l_tau[-(2+i)])) )
            else:
                grad_c.append(0.0)
        return exp(-0.6524*self.model.predict([grad_c])[0][0])

